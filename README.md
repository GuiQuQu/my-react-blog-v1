# 遗留问题总结

1. edit页面在宽度缩小之后,点击按钮展开导航栏目录时,会有一部分编辑内容被遮住无法看到,不过收起导航栏就会正常,影响不算太大

# 需要追加的功能

1. 目前新建文章和修改文章的入口还没有做
2. 新建文件夹和删除文件夹也没有做
3. 目前左侧的目录栏和具体某一篇文章还有联系起来
4. 需要修改一个左侧目录栏的样式
5. 制作某选文章被选中或者是滚动到某一章节时的激活效果
# 对于上述问题的一些想法
1. 修改文章的按钮,放在文章顶部的右侧,采用三点图标,点击时出现菜单, 有2个按钮 (1) 编辑 (2) 删除
2. 考虑要写一个新的页面,存在该文件夹下的所有内容,点击文件夹标签时进入
在这个页面
    1. 预览该文件夹下的所有内容
    2. 修改相应的文件夹信息
    3. 新建文件
3. 优先做3
4. 
5. 

网站目录树中有两个节点
1. 非叶节点,文件夹,具有的属性
    - id
    - name
    - children: \[其他id的数组\]
2. 叶节点,文件,具有的属性
    - id
    - name
    - link
    - 然后是一些预览信息属性

在非叶节点读取孩子节点内容,如果不返回给该节点的子节点的全部信息,那么必须要知道整个的树的信息,否则无法对子节点进行渲染,目前的做法是通过Context上下文传递整个目录树的信息

# 目前后端的想法
1. 使用git管理所有新建的文件夹和文件,可以保证数据内容的更新安全
    在新建文件夹或者文件时,起名按照给的name来起

2. 使用数据库来保存在目录树结构
    
    Question:如何通过数据库的树结构来保证找到对应的文章？
 
    关系型数据库中应该具有的属性
    
    id name type author children path
    
    id 文件或者文件夹id
    
    name 文件或者文件夹的名称
    
    author 创建该文件或者文件夹的用户

    type 说明该节点是文件夹还是文件
    
    children 文件夹有值,为id的数组,文件为[]
    
    path 文件或者文件夹的路径


3. 新建文件或者文件夹
    
    1.1 新建文件 传入name,article,dir_id 到后端
    
    获取dir_id 对应的 dir_path,然后with open写入文件,完成新建,并且生成新的id,name,path等保存在数据库中的内容
    
    1.2 新建文件夹 传入 name,dir_id 到后端
    
    获取dir_id 对应的 dir_path,然后使用makedirs来完成文件夹新建,并且生成新的id,name,path等保存在数据库中的内容

4. 修改文件或者文件夹
    
    4.1 修改文件,传入article_id,name,new_article
    
    通过article_id获取文件夹目录,然后使用new_article来修改文件
    使用name来更新文件的新名字和path
    
    4.2 修改文件夹,修改文件夹只能修改文件夹的名字,传入dir_id, new_dir_name
        
    在数据库中修改dir_id对应的文件夹名字,并且修改其path
        在实际文件系统中通过move命令来改名

5. 移动文件或者文件夹,输入需要移动的文件或者文件夹id,其父节点的id,目标的文件夹id
    
    在数据库中,修改邻接表中的两行内容即可,然后实际的文件移动可以使用move命令执行

6. 删除文件和文件夹 
    
    6.1 删除文件比较简单,传入article_id,删除数据库中对应行内容,然后通过linux命令删除具体文件
    
    6.2 删除文件夹时,需要先递归的删除该文件夹下的全部内容,然后才可以删除自己
7. 查询文件或者文件夹,可以通过id在数据库中寻找内容
    
    7.1 当查询的节点是文件时,需要打开该文件,读取内容并返回,并且返回显示文件夹需要的内容(Article.jsx)
    
    7.2 当查询的节点时文件夹时,需要将其孩子节点对应id的数据一并获取,并且返回显示文件夹需要的内容(ArticleCategory.jsx)

文件的上传和修改,Hexo这种会依靠git来做,这样看起来明显就安心的多,所以我也想通过git做来这部分内容

# 系统内的url设定

将所有的数据都放到Django的static文件夹下是可以直接访问的,没必要使用静态路由,这样访问的没有渲染,应该还是需要做一下的

对于文章页,url应该是域名:端口/目录1/目录2/.../article_id

对于文件夹页,url应该是域名:端口/目录1/目录2/.../category_id

# 系统内所有的url的样式
1. 文章页
    
    域名:端口/目录1/目录2/.../article_id

2. 文章编辑页

    域名:端口/目录1/目录2/.../article_id/edit

3. 目录页

    域名:端口/目录1/目录2/.../目录n

# 自我否定定定定定定定定定定定定定定

1. 如果只有我一个人编辑,实际上是不需要在线编辑的富文本编辑器,自己的编辑完全可以自己在本地编辑,实际体验也会更好,我只需要精细展示页就可以了。

2. 展示页的根url是/blog/, 需要和一个本地对应路径绑定("/user/blog/"等等) 
```
config.json
{
    basePath: "./user/blog",
    baseUrl: "/blog",
}
```
3. 然后我需要根据本地目录来虚拟路由

4. 整体应用在第一次请求后端之后完全静态,不在向后端发送任何请求

Q1: js是浏览器语言,对于读取本地目录这样事情并不方便

A1: 我交给后端做,因此配置文件`config.json`也放到后端,让后端读取,读到之后发送过来

Q2: 我是否还需要用自己的服务器? 

要使用自己的服务器,就会导致每一次在本地写完文档之后必须手动上传上去,体验并不是很好, 

但是如果依托github Page等内容,不仅有墙的问题,自己的域名也完全没用了。因此决定还是要**使用自己的服务器**

**解决手动上传的问题**
需要自己在本地写一个Typora的插件,在保存之后自动传服务器的某个文件夹上上传,如果没法自动,则是需要自己写一个python脚本手动运行了,也只能稍微缓解

因此在自我否定之后,我目前的决定:

### 1. 依托自己的服务器

### 2. 放弃在线文本编辑器

### 3. 需要写一个本地的文件上传脚本

保证这三点的前端写法

1. 只需要一个展示页,展示页中的内容左侧全部文章, 中间文章, 右侧目录

    Q3: 左侧目录是否需要完全递归,要递归怎么递归？

对于后端需要发送过来的内容,完全的目录树
```
{

}
```
